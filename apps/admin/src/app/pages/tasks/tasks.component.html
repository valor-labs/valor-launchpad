<button
  valor-launchpad-button
  class="float-end mt-n1"
  (click)="openAddTaskModel()"
>
  <i class="fas fa-plus"></i> New task
</button>
<h1 class="h3 mb-3">Tasks</h1>

<div valorLaunchpadRow cdkDropListGroup>
  <div valorLaunchpadCol [span]="12" [lg]="6" [xl]="4">
    <valor-launchpad-card>
      <valor-launchpad-card-header>
        <div class="card-actions float-end">
          <valor-launchpad-dropdown [direction]="'end'">
            <i dropdown-nav class="align-middle fas fa-fw fa-ellipsis-h"></i>
            <valor-launchpad-dropdown-actions-menu
              [actions]="upComingActions"
            ></valor-launchpad-dropdown-actions-menu>
          </valor-launchpad-dropdown>
        </div>
        <h5 class="card-title">Upcoming</h5>
        <h6 class="card-subtitle text-muted">
          Nam pretium turpis et arcu. Duis arcu.
        </h6>
      </valor-launchpad-card-header>
      <valor-launchpad-card-content>
        <div
          id="tasks-upcoming"
          cdkDropList
          [cdkDropListData]="taskGroup.upcoming"
          (cdkDropListDropped)="onDrop($event)"
        >
          <valor-launchpad-card
            cdkDrag
            class="mb-3 bg-light cursor-grab border"
            *ngFor="let task of taskGroup.upcoming"
          >
            <valor-launchpad-card-content>
              <div class="float-end mr-n2">
                <label class="form-check">
                  <input
                    type="checkbox"
                    class="form-check-input"
                    aria-label="completed"
                  />
                </label>
              </div>
              <p>{{ task.desc }}</p>
              <div class="float-end mt-n1">
                <img
                  [src]="task.user.avatar"
                  width="32"
                  height="32"
                  class="rounded-circle"
                  alt="Avatar"
                />
              </div>
              <button
                valor-launchpad-button
                size="sm"
                (click)="openViewTaskModel(task)"
              >
                View
              </button>
            </valor-launchpad-card-content>
          </valor-launchpad-card>
        </div>

        <div class="d-grid">
          <button valor-launchpad-button (click)="openAddTaskModel('UPCOMING')">
            Add new task
          </button>
        </div>
      </valor-launchpad-card-content>
    </valor-launchpad-card>
  </div>
  <div valorLaunchpadCol [span]="12" [lg]="6" [xl]="4">
    <valor-launchpad-card>
      <valor-launchpad-card-header>
        <div class="card-actions float-end">
          <valor-launchpad-dropdown [direction]="'end'">
            <i dropdown-nav class="align-middle fas fa-fw fa-ellipsis-h"></i>
            <valor-launchpad-dropdown-actions-menu
              [actions]="inProgressActions"
            ></valor-launchpad-dropdown-actions-menu>
          </valor-launchpad-dropdown>
        </div>
        <h5 class="card-title">In Progress</h5>
        <h6 class="card-subtitle text-muted">
          Nam pretium turpis et arcu. Duis arcu.
        </h6>
      </valor-launchpad-card-header>
      <valor-launchpad-card-content>
        <div
          id="tasks-progress"
          cdkDropList
          [cdkDropListData]="taskGroup.inprogress"
          (cdkDropListDropped)="onDrop($event)"
        >
          <valor-launchpad-card
            cdkDrag
            class="mb-3 bg-light cursor-grab border"
            *ngFor="let task of taskGroup.inprogress"
          >
            <valor-launchpad-card-content>
              <div class="float-end mr-n2">
                <label class="form-check">
                  <input
                    type="checkbox"
                    class="form-check-input"
                    aria-label="completed"
                  />
                </label>
              </div>
              <p>{{ task.desc }}</p>
              <div class="float-end mt-n1">
                <img
                  [src]="task.user.avatar"
                  width="32"
                  height="32"
                  class="rounded-circle"
                  alt="Avatar"
                />
              </div>
              <button
                valor-launchpad-button
                size="sm"
                (click)="openViewTaskModel(task)"
              >
                View
              </button>
            </valor-launchpad-card-content>
          </valor-launchpad-card>
        </div>

        <div class="d-grid">
          <button
            valor-launchpad-button
            (click)="openAddTaskModel('IN_PROGRESS')"
          >
            Add new task
          </button>
        </div>
      </valor-launchpad-card-content>
    </valor-launchpad-card>
  </div>
  <div valorLaunchpadCol [span]="12" [lg]="6" [xl]="4">
    <valor-launchpad-card>
      <valor-launchpad-card-header>
        <div class="card-actions float-end">
          <valor-launchpad-dropdown [direction]="'end'">
            <i dropdown-nav class="align-middle fas fa-fw fa-ellipsis-h"></i>
            <valor-launchpad-dropdown-actions-menu
              [actions]="completedActions"
            ></valor-launchpad-dropdown-actions-menu>
          </valor-launchpad-dropdown>
        </div>
        <h5 class="card-title">Completed</h5>
        <h6 class="card-subtitle text-muted">
          Nam pretium turpis et arcu. Duis arcu.
        </h6>
      </valor-launchpad-card-header>
      <valor-launchpad-card-content>
        <div
          id="tasks-completed"
          cdkDropList
          [cdkDropListData]="taskGroup.completed"
          (cdkDropListDropped)="onDrop($event)"
        >
          <valor-launchpad-card
            cdkDrag
            class="mb-3 bg-light cursor-grab border"
            *ngFor="let task of taskGroup.completed"
          >
            <valor-launchpad-card-content>
              <div class="float-end mr-n2">
                <label class="form-check">
                  <input
                    type="checkbox"
                    class="form-check-input"
                    aria-label="completed"
                    checked="true"
                  />
                </label>
              </div>
              <p>{{ task.desc }}</p>
              <div class="float-end mt-n1">
                <img
                  [src]="task.user.avatar"
                  width="32"
                  height="32"
                  class="rounded-circle"
                  alt="Avatar"
                />
              </div>
              <button
                valor-launchpad-button
                size="sm"
                (click)="openViewTaskModel(task)"
              >
                View
              </button>
            </valor-launchpad-card-content>
          </valor-launchpad-card>
        </div>

        <div class="d-grid">
          <button
            valor-launchpad-button
            (click)="openAddTaskModel('COMPLETED')"
          >
            Add new task
          </button>
        </div>
      </valor-launchpad-card-content>
    </valor-launchpad-card>
  </div>
</div>

<valor-launchpad-modal
  bsModal
  #taskModal="bs-modal"
  heading="Add Task"
  [footer]="taskFooterTmpl"
  [content]="taskContentTmpl"
>
  <ng-template #taskFooterTmpl>
    <button
      valor-launchpad-button
      theme="secondary"
      (click)="cancelTaskModel()"
    >
      Cancel
    </button>
    <button
      *ngIf="modelType === 'Edit' || modelType === 'Add'"
      valor-launchpad-button
      theme="primary"
      [disabled]="
        taskFormGroup.invalid || (modelType === 'Edit' && !taskFormGroup.dirty)
      "
      (click)="submitTaskModel()"
    >
      Save
    </button>
    <button
      *ngIf="modelType === 'View' && false"
      valor-launchpad-button
      theme="primary"
      [disabled]="taskFormGroup.invalid"
      (click)="editTask()"
    >
      Edit
    </button>
    <button
      *ngIf="modelType === 'View'"
      valor-launchpad-button
      theme="primary"
      [disabled]="taskFormGroup.invalid"
      (click)="deleteTask()"
    >
      Delete
    </button>
  </ng-template>
  <ng-template #taskContentTmpl>
    <form [formGroup]="taskFormGroup">
      <valor-launchpad-form-item>
        <valor-launchpad-form-label [required]="true"
          >Title</valor-launchpad-form-label
        >
        <input
          valorLaunchpadInput
          formControlName="title"
          placeholder="Enter title"
        />
      </valor-launchpad-form-item>
      <valor-launchpad-form-item>
        <valor-launchpad-form-label [required]="true"
          >Desc</valor-launchpad-form-label
        >
        <textarea
          valorLaunchpadInput
          rows="2"
          placeholder="Enter desc"
          formControlName="desc"
        ></textarea>
      </valor-launchpad-form-item>
      <valor-launchpad-form-item>
        <valor-launchpad-form-label [required]="true"
          >Status</valor-launchpad-form-label
        >
        <select
          class="form-select mb-3"
          formControlName="taskStatus"
          placeholder="Select status"
          readonly
        >
          <option *ngFor="let type of taskTypes" [value]="type">
            {{ getTaskTypeLabel(type) }}
          </option>
        </select>
      </valor-launchpad-form-item>
    </form>
  </ng-template>
</valor-launchpad-modal>
