<main id="main" class="checkout" [ngClass]="mainClasses">
  <div id="checkout">
    <!--    TODO: Add this back-->
    <!--    <div id="payment-request" [ngClass]="{'visible':paymentRequestVisible}">-->
    <!--      <div id="payment-request-button"></div>-->
    <!--    </div>-->
    <form id="payment-form" [formGroup]='addressForm'>
      <p class="instruction"><span>Complete</span>/<span id="generate" (click)="generate()">generate</span> your
        shipping and payment details
        below</p>
      <section>
        <h2>Shipping &amp; Billing Information</h2>
        <fieldset class="with-state">
          <label>
            <span>Name</span>
            <input name="name" formControlName="name" class="field" placeholder="Jenny Rosen" required>
          </label>
          <label>
            <span>Email</span>
            <input name="email" formControlName="email" type="email" class="field" placeholder="jenny@example.com"
                   required>
          </label>
          <label>
            <span>Address</span>
            <input name="address" formControlName="address" class="field" placeholder="185 Berry Street Suite 550">
          </label>
          <label class="city">
            <span>City</span>
            <input name="city" formControlName="city" class="field" placeholder="San Francisco">
          </label>
          <label class="state">
            <span>State</span>
            <input name="state" formControlName="state" class="field" placeholder="CA">
          </label>
          <label class="zip">
            <span>ZIP</span>
            <input name="postal_code" formControlName="postal_code" class="field" placeholder="94107">
          </label>
          <label class="select">
            <span>Country</span>
            <div id="country" class="field {{addressForm.controls['country'].value|lowercase}}">
              <select name="country" formControlName="country">
                <option value="AU">Australia</option>
                <option value="AT">Austria</option>
                <option value="BE">Belgium</option>
                <option value="BR">Brazil</option>
                <option value="CA">Canada</option>
                <option value="CN">China</option>
                <option value="DK">Denmark</option>
                <option value="FI">Finland</option>
                <option value="FR">France</option>
                <option value="DE">Germany</option>
                <option value="HK">Hong Kong</option>
                <option value="IE">Ireland</option>
                <option value="IT">Italy</option>
                <option value="JP">Japan</option>
                <option value="LU">Luxembourg</option>
                <option value="MY">Malaysia</option>
                <option value="MX">Mexico</option>
                <option value="NL">Netherlands</option>
                <option value="NZ">New Zealand</option>
                <option value="NO">Norway</option>
                <option value="PL">Poland</option>
                <option value="PT">Portugal</option>
                <option value="SG">Singapore</option>
                <option value="ES">Spain</option>
                <option value="SE">Sweden</option>
                <option value="CH">Switzerland</option>
                <option value="GB">United Kingdom</option>
                <option value="US">United States</option>
              </select>
            </div>
          </label>
        </fieldset>
        <p class="tip">Select another country to see different payment options.</p>
      </section>
      <section>
        <h2>Payment Information</h2>
        <nav id="payment-methods">
          <ul>
            <li>
              <input type="radio" name="payment" id="payment-card" value="card" checked>
              <label for="payment-card">Card</label>
            </li>
            <li>
              <input type="radio" name="payment" id="payment-ach_credit_transfer" value="ach_credit_transfer" checked>
              <label for="payment-ach_credit_transfer">Bank Transfer</label>
            </li>
            <li>
              <input type="radio" name="payment" id="payment-alipay" value="alipay">
              <label for="payment-alipay">Alipay</label>
            </li>
            <li>
              <input type="radio" name="payment" id="payment-bancontact" value="bancontact">
              <label for="payment-bancontact">Bancontact</label>
            </li>
            <li>
              <input type="radio" name="payment" id="payment-eps" value="eps">
              <label for="payment-eps">EPS</label>
            </li>
            <li>
              <input type="radio" name="payment" id="payment-ideal" value="ideal">
              <label for="payment-ideal">iDEAL</label>
            </li>
            <li>
              <input type="radio" name="payment" id="payment-giropay" value="giropay">
              <label for="payment-giropay">Giropay</label>
            </li>
            <li>
              <input type="radio" name="payment" id="payment-multibanco" value="multibanco">
              <label for="payment-multibanco">Multibanco</label>
            </li>
            <li>
              <input type="radio" name="payment" id="payment-p24" value="p24">
              <label for="payment-p24">Przelewy24</label>
            </li>
            <li>
              <input type="radio" name="payment" id="payment-sepa_debit" value="sepa_debit">
              <label for="payment-sepa_debit">SEPA Direct Debit</label>
            </li>
            <li>
              <input type="radio" name="payment" id="payment-sofort" value="sofort">
              <label for="payment-sofort">SOFORT</label>
            </li>
            <li>
              <input type="radio" name="payment" id="payment-wechat" value="wechat">
              <label for="payment-wechat">WeChat Pay</label>
            </li>
            <li>
              <input type="radio" name="payment" id="payment-au_becs_debit" value="au_becs_debit">
              <label for="payment-au_becs_debit">BECS Direct Debit</label>
            </li>
          </ul>
        </nav>
        <div class="payment-info card visible">
          <fieldset>
            <label>
              <span>Card</span>
              <div id="card-element" class="field"></div>
            </label>
          </fieldset>
        </div>
        <div class="payment-info sepa_debit">
          <fieldset>
            <label>
              <span>IBAN</span>
              <div id="iban-element" class="field"></div>
            </label>
          </fieldset>
          <p class="notice">By providing your IBAN and confirming this payment, you’re authorizing Payments Demo and
            Stripe, our payment
            provider, to send instructions to your bank to debit your account. You’re entitled to a refund under the
            terms
            and conditions of your agreement with your bank.</p>
        </div>
        <div class="payment-info ideal">
          <fieldset>
            <label>
              <span>iDEAL Bank</span>
              <div id="ideal-bank-element" class="field"></div>
            </label>
          </fieldset>
        </div>
        <div class="payment-info redirect">
          <p class="notice">You’ll be redirected to the banking site to complete your payment.</p>
        </div>
        <div class="payment-info receiver">
          <p class="notice">Payment information will be provided after you place the order.</p>
        </div>
        <div class="payment-info wechat">
          <div id="wechat-qrcode"></div>
          <p class="notice">Click the button below to generate a QR code for WeChat.</p>
        </div>
        <div class="payment-info au_becs_debit">
          <fieldset>
            <label>
              <span>Bank Account</span>
              <div id="becs-bank-element" class="field"></div>
            </label>
          </fieldset>
          <p class="notice">By providing your bank account details and confirming this payment, you agree to this Direct
            Debit Request and
            the Direct Debit Request service agreement, and authorise Stripe Payments Australia Pty Ltd ACN 160 180 343
            Direct Debit User ID
            number 507156 (“Stripe”) to debit your account through the Bulk Electronic Clearing System (BECS) on behalf
            of Stripe Payments Demo
            (the “Merchant”) for any amounts separately communicated to you by the Merchant. You certify that you are
            either an account
            holder or an authorised signatory on the account listed above.</p>
        </div>
      </section>
      <button class="payment-button" type="button" (click)="submit()"
              [attr.disabled]="submitDisabled?true:null">{{submitButtonPayText}}</button>
    </form>
    <div id="card-errors" class="element-errors"></div>
    <div id="iban-errors" class="element-errors"></div>
    <div id="becs-errors" class="element-errors"></div>
  </div>
  <div id="confirmation">
    <div class="status processing">
      <h1>Completing your order…</h1>
      <p>We’re just waiting for the confirmation from your bank… This might take a moment but feel free to close this
        page.</p>
      <p>We’ll send your receipt via email shortly.</p>
    </div>
    <div class="status success">
      <h1>Thanks for your order!</h1>
      <p>Woot! You successfully made a payment with Stripe.</p>
      <p class="note">{{confirmationMessage}}</p>
    </div>
    <div class="status receiver">
      <h1>Thanks! One last step!</h1>
      <p>Please make a payment using the details below to complete your order.</p>
      <div class="info"></div>
    </div>
    <div class="status error">
      <h1>Oops, payment failed.</h1>
      <p>It looks like your order could not be paid at this time. Please try again or select a different payment
        option.</p>
      <p class="error-message">{{errorText}}</p>
    </div>
  </div>
</main>
<aside id="summary">
  <div class="header">
    <h1>Order Summary</h1>
  </div>
  <div id="order-items">
    <div *ngFor="let product of orderItems" class="line-item">
      <img class="image" [src]="'/assets/products/'+product.id+'.png'" alt="{{product.name}}">
      <div class="label">
        <p class="product">{{product.name}}</p>
        <div class="sku">
          <div *ngFor="let attribute of product.sku.attributes | keyvalue">{{attribute.value}}</div>
        </div>
      </div>
      <p class="count">{{product.quantity}} x {{product.skuPrice}}</p>
      <p class="price">{{product.lineItemPrice}}</p>
    </div>
  </div>
  <div id="order-total">
    <div class="line-item subtotal">
      <p class="label">Subtotal</p>
      <p class="price">{{subtotal}}</p>
    </div>
    <div class="line-item shipping">
      <p class="label">Shipping</p>
      <p class="price">Free</p>
    </div>
    <div class="line-item demo" *ngIf="!live">
      <div id="demo">
        <p class="label">Demo in test mode</p>
        <p class="note">You can copy and paste the following test cards to trigger different scenarios:</p>
        <table class="note">
          <tr>
            <td>Default US card:</td>
            <td class="card-number">4242<span></span>4242<span></span>4242<span></span>4242</td>
          </tr>
          <tr>
            <td><a href="https://stripe.com/guides/strong-customer-authentication" target="_blank">Authentication</a>
              required:
            </td>
            <td class="card-number">4000<span></span>0027<span></span>6000<span></span>3184</td>
          </tr>
        </table>
        <p class="note">
          See the <a href="https://stripe.com/docs/testing#cards" target="_blank">docs</a> for a full list of test
          cards.
          Non-card payments will redirect to test pages.
        </p>
      </div>
    </div>
    <div class="line-item total">
      <p class="label">Total</p>
      <p class="price">{{orderTotal}}</p>
    </div>
  </div>
</aside>
